class SendForm{constructor(){(this.info=document.createElement("div")).classList.add("info");this.message={loading:"Загрузка...",success:"Спасибо! Скоро мы с вами свяжемся",error:"Что-то пошло не так",phone:"Введите телефон!"}}processForm(e){for(let t=0;t<e.elements.length;t++)"submit"!==e.elements[t].type&&(e.elements[t].setAttribute("required","required"),e.elements[t].addEventListener("blur",e=>(new Validation).formValidate(e)));e.elements.message&&e.elements.message.addEventListener("input",e=>this.textAreaEdit(e)),e.addEventListener("submit",e=>this.sendForm(e))}sendForm(e){const t=e.target,{elements:n}=t,s=this.message;event.preventDefault();let a=document.createElement("div");a.classList.add("form__message");let r={};for(let e in n)n.hasOwnProperty(e)&&n[e].name&&(r[n[e].name]=n[e].value);let i=new XMLHttpRequest;i.open("POST","https://gipsolit-site.herokuapp.com/clients"),i.setRequestHeader("Content-type","application/json; charset = utf-8"),i.send(JSON.stringify(r)),t.append(a);let o=t;i.addEventListener("readystatechange",(function(){i.readyState<4?a.textContent=s.loading:4===i.readyState&&200===i.status?((new Popup).showPopup("#popup-thanks"),o.removeChild(a)):a.textContent=s.error})),this.clearInputs(t)}clearInputs(e){for(let t=0;t<e.elements.length;t++)e.elements[t].value="",e.elements[t].style.border="1px solid #dddddd"}textAreaEdit(e){const t=e.target,{value:n}=t;n.length<=50&&(t.maxLength=50,this.info.innerText="Осталось символов "+(50-n.length),t.parentNode.append(this.info))}}